(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77ba29ca"],{"03e7":function(s,t,a){var e={"./1.跳转授权.md":"f7fd","./2.获取用户信息.md":"4dcf","./3.access_token获取.md":"6f09","./4.模板消息.md":"1658","./5.服务器地址(URL)开发接入.md":"428d","./6.XML处理发送.md":"36ec","./7.微信关注公众号回调.md":"225d"};function r(s){var t=n(s);return a(t)}function n(s){if(!a.o(e,s)){var t=new Error("Cannot find module '"+s+"'");throw t.code="MODULE_NOT_FOUND",t}return e[s]}r.keys=function(){return Object.keys(e)},r.resolve=n,s.exports=r,r.id="03e7"},1658:function(s,t,a){"use strict";a.r(t);var e=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},r=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("h2",[s._v("4.微信推送")]),a("br"),a("p",[s._v("来源：小白 时间：2020年12月22日17:27:50")]),a("br"),a("hr"),a("blockquote",[a("p",[s._v("环境：node，request包")])]),a("blockquote",[a("p",[s._v("难度：简单")])]),a("br"),a("blockquote",[a("h4",[s._v("0.申请微信消息模板 --已申请/有经验的跳过")])]),a("br"),a("blockquote",[a("h4",[s._v("1.发送微信推送")])]),a("br"),a("blockquote",[a("h4",[s._v("2.获取模板列表")])]),a("br"),a("blockquote",[a("h4",[s._v("3.删除模板")])]),a("br"),a("br"),a("h3",[s._v("申请微信模板消息")]),a("br"),a("h4",[s._v("0.1登录微信公众平台以后点击这里查看模板消息")]),a("br"),a("p",[a("img",{attrs:{src:"http://www.zzf9.com/admin/images/20-12-24-vgtr45.jpg",alt:"charles 1"}})]),a("blockquote",[a("p",[s._v("提醒：如果没此选项，请到功能=》添加功能插件=》模板消息中添加")])]),a("br"),a("h4",[s._v("0.2选择合适的模板")]),a("br"),a("p",[s._v("这一步的话是选择模板，如果没有合适的话可以手动创建（需要微信公众平台审核，需要时间）")]),a("p",[a("img",{attrs:{src:"http://www.zzf9.com/admin/images/20-12-24-rwer4.jpg",alt:"charles 1"}})]),a("p",[s._v("如果未所属行业，请选择然后请选择所属行业 如果有的话 请直接点击模板库的某一个模板查看详情 详情里面有添加 就会得到模板ID 根据模板ID去发送删除模板")]),a("p",[a("img",{attrs:{src:"http://www.zzf9.com/admin/images/20-12-24-twer83.jpg",alt:"charles 1"}})]),a("p",[a("img",{attrs:{src:"http://www.zzf9.com/admin/images/20-12-24-ft87q.jpg",alt:"charles 1"}})]),a("p",[s._v("请注意后面的参数 你发送的时候在data数据格式中应该为相应的格式")]),a("p",[a("code",{pre:!0},[s._v("{{first.DATA}}")]),s._v(' 即为 {first:"xxxxx"}')]),a("p",[s._v("例如上图发送的格式应该为")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"data"')]),s._v(":{\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"first"')]),s._v(": {\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"您好，您的近7日睡眠报告如下"')]),s._v(",\n    },\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"keyword1"')]),s._v(":{\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"睡眠统计时间"')]),s._v(",\n    },\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"keyword2"')]),s._v(": {\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"睡眠评估"')]),s._v(",\n    },\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"keyword3"')]),s._v(": {\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"斯百瑞设备"')]),s._v(",\n    },\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"keyword4"')]),s._v(": {\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"AHI指数"')]),s._v(",\n    },\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"keyword5"')]),s._v(": {\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"血氧指数"')]),s._v(",\n    },\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"remark"')]),s._v(":{\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"该报告为您近7天统计使用报告！"')]),s._v(",\n    }\n}\n")])]),a("p",[s._v("添加完成以后你就获得了模板ID")]),a("br"),a("h3",[s._v("1.发送微信推送")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("templateSend")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ touser, template_id, url, miniprogram, data, appid, pagepath, access_token }")]),s._v(") ")]),s._v("{\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _miniprogram = miniprogram || "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (appid && "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" miniprogram !== "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'object'")]),s._v(") {\n        _miniprogram = {\n            appid,\n            "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("pagepath")]),s._v(": pagepath || "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n        }\n    }\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" fromData = {\n        touser,\n        template_id,\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("url")]),s._v(": url || "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("miniprogram")]),s._v(": _miniprogram,\n        data\n    };\n    request({\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("url")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`https://api.weixin.qq.com/cgi-bin/message/template/send?access_token="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${access_token}")]),s._v("`")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("method")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'POST'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//请求方式，默认为get")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("headers")]),s._v(": {\n            "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//设置请求头")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'content-type'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'application/json'")]),s._v("\n        },\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("body")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".stringify(fromData)\n    }, (error, response, body) => {\n        "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (err) {\n            "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(err) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//异常接口")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v("\n        } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n            "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!error && response.statusCode == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(") {\n                "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(response.body) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//发送完成")]),s._v("\n            }\n        }\n    })\n}\n\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用  请输入对象格式传参 如下")]),s._v("\ntemplateMsg({"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("touser")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"xxxxx"')]),s._v(","),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("template_id")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"appsecret"')]),s._v(","),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("appid")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('""')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(": {} })\n\n")])]),a("p",[s._v("templateMsg参数说明")]),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("参数")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("是否必填")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("说明")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("touser")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("接收者openid")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("template_id")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("模板ID")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("url")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("否")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("模板跳转链接（海外帐号没有跳转能力）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("miniprogram")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("否")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("跳小程序所需数据，不需跳小程序可不用传该数据")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("appid")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("所需跳转到的小程序appid（该小程序appid必须与发模板消息的公众号是绑定关联关系，暂不支持小游戏）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("pagepath")]),a("td",{staticStyle:{"text-align":"left"}}),a("td",{staticStyle:{"text-align":"left"}},[s._v("否")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("data")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("模板数据")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("color")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("否")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("模板内容字体颜色，不填默认为黑色")])])])]),a("p",[s._v("发送的post格式为")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[s._v("  {\n           "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"touser"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"OPENID"')]),s._v(",\n           "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"template_id"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ngqIpbwh8bUfcSsECmogfXcV14J0tQlEpBO27izEYtY"')]),s._v(",\n           "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"url"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"http://weixin.qq.com/download"')]),s._v(",  \n           "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"miniprogram"')]),s._v(":{\n             "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"appid"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"xiaochengxuappid12345"')]),s._v(",\n             "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"pagepath"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"index?foo=bar"')]),s._v("\n           },          \n           "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"data"')]),s._v(":{\n                   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"first"')]),s._v(": {\n                       "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"恭喜你购买成功！"')]),s._v(",\n                       "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"color"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"#173177"')]),s._v("\n                   },\n                   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"keyword1"')]),s._v(":{\n                       "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"巧克力"')]),s._v(",\n                       "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"color"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"#173177"')]),s._v("\n                   },\n                   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"keyword2"')]),s._v(": {\n                       "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"39.8元"')]),s._v(",\n                       "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"color"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"#173177"')]),s._v("\n                   },\n                   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"keyword3"')]),s._v(": {\n                       "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"2014年9月22日"')]),s._v(",\n                       "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"color"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"#173177"')]),s._v("\n                   },\n                   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"remark"')]),s._v(":{\n                       "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"value"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"欢迎再次购买！"')]),s._v(",\n                       "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"color"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"#173177"')]),s._v("\n                   }\n           }\n\t   }\n")])]),a("br"),a("h3",[s._v("2.获取模板列表")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("getTemplateList")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ access_token }")]),s._v(") ")]),s._v("{\n\trequest({\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("url")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`https://api.weixin.qq.com/cgi-bin/template/get_all_private_template?access_token="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${access_token}")]),s._v("`")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("method")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'get'")]),s._v(",\n\t},(err,res) =>{\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(err){\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(err) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//异常接口")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v("\n\t\t}"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v("{\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".parse(resv.body)) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//用户数据")]),s._v("\n\t\t}\n\t})\n}\n\ngetTemplateList({"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("access_token")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('""')]),s._v("})\n\n")])]),a("p",[s._v("参数说明")]),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("参数")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("是否必须")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("说明")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("access_token")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("接口调用凭证")])])])]),a("p",[s._v("正确的返回")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[s._v("{\t\n     "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"template_list"')]),s._v(": [{\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"template_id"')]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"iPk5sOIt5X_flOVKn5GrTFpncEYTojx6ddbt8WYoV5s"')]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"title"')]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"领取奖金提醒"')]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"primary_industry"')]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"IT科技"')]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"deputy_industry"')]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"互联网|电子商务"')]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"content"')]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"{ {result.DATA} }\\n\\n领奖金额:{ {withdrawMoney.DATA} }\\n领奖  时间:    { {withdrawTime.DATA} }\\n银行信息:{ {cardInfo.DATA} }\\n到账时间:  { {arrivedTime.DATA} }\\n{ {remark.DATA} }"')]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"example"')]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"您已提交领奖申请\\n\\n领奖金额：xxxx元\\n领奖时间：2013-10-10 12:22:22\\n银行信息：xx银行(尾号xxxx)\\n到账时间：预计xxxxxxx\\n\\n预计将于xxxx到达您的银行卡"')]),s._v("\n   }]\n}\n")])]),a("p",[s._v("返回参数说明")]),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("参数")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("是否必填")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("说明")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("access_token")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("接口调用凭证")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("template_id")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("模板ID")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("title")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("模板标题")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("primary_industry")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("模板所属行业的一级行业")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("deputy_industry")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("模板所属行业的二级行业")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("content")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("模板内容")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("example")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("模板示例")])])])]),a("br"),a("h3",[s._v("3.删除模板")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/** \n    @description:删除模板\n    @param access_token {string} 接口调用凭证\n    @param template_id {string} 模板ID\n    @return:\n*/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("deleteTemplateList")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ access_token , template_id }")]),s._v(") ")]),s._v("{\n\trequest({\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("url")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`https://api.weixin.qq.com/cgi-bin/template/del_private_template?access_token="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${access_token}")]),s._v("`")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("method")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'POST'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//请求方式，默认为get")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("headers")]),s._v(": {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//设置请求头")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'content-type'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'application/json'")]),s._v("\n\t\t},\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("body")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".stringify({template_id})\n\t},(error, response, body) =>{\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(err){\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(err) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//异常接口")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v("\n\t\t}"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v("{\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!error && response.statusCode == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(response.body) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//发送完成")]),s._v("\n\t\t\t}\n\t\t}\n\t})\n}\n\ndeleteTemplateList({"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("access_token")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('""')]),s._v(","),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("template_id")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('""')]),s._v("})\n\n")])]),a("p",[s._v("返回说明")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[s._v("{\n   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"errcode"')]),s._v(" : "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"errmsg"')]),s._v(" : "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ok"')]),s._v("\n}\n")])]),a("br"),a("h5",[a("a",{attrs:{href:"https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Template_Message_Interface.html"}},[s._v("》官网文档传送门《")])])])}],n=a("2877"),l={},p=Object(n["a"])(l,e,r,!1,null,null,null);t["default"]=p.exports},"225d":function(s,t,a){"use strict";a.r(t);var e=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},r=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("h2",[s._v("7.微信关注公众号回调")]),a("br"),a("p",[s._v("来源：小白 时间：2020年12月25日09:50:54")]),a("hr"),a("blockquote",[a("p",[s._v("环境：node，xml2js，crypto包")])]),a("blockquote",[a("p",[s._v("难度：简单")])]),a("blockquote",[a("p",[s._v("此步骤前请先完成"),a("a",{attrs:{href:"http://plug.zzf9.com/#/officialAccountsRender/A4"}},[s._v("步骤五，配置服务器地址URL开发接入")]),s._v("才可继续操作")])]),a("blockquote",[a("p",[s._v("npm install xml2js")])]),a("br"),a("p",[s._v("请先完成"),a("a",{attrs:{href:"http://plug.zzf9.com/#/officialAccountsRender/A4"}},[s._v("步骤五，配置服务器地址URL开发接入")]),s._v(" 拿到正确的json")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[s._v("   { xml:\n        { ToUserName: [ 'xxxx' ],\n    FromUserName: [ 'xxxx' ],\n    CreateTime: [ 'xxxxx' ],\n    MsgType: [ 'event' ],\n    Event: [ 'unsubscribe' ],\n    EventKey: [ '' ] } \n   }\n")])]),a("br"),a("h3",[s._v("1验证是否为微信回调")]),a("br"),a("p",[s._v("微信回调按照1步骤解析后的数据格式应该为"),a("code",{pre:!0},[s._v("xml.Event")]),s._v("进行判断 如果是"),a("code",{pre:!0},[s._v("unsubscribe")]),s._v("为取消关注 否则"),a("code",{pre:!0},[s._v("subscribe")]),s._v("为关注 "),a("br")]),a("p",[s._v("如上代码为判断数据是否为关注事件 _props格式为如下JSON "),a("br"),a("br")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-JSON"}},[s._v("   { "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"xml"')]),s._v(":\n        { "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"ToUserName"')]),s._v(": [ "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"xxxx"')]),s._v(" ],\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"FromUserName"')]),s._v(": [ "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"xxxx"')]),s._v(" ],\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"CreateTime"')]),s._v(": [ "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"xxxxx"')]),s._v(" ],\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"MsgType"')]),s._v(": [ "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"event"')]),s._v(" ],\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"Event"')]),s._v(": [ "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"unsubscribe"')]),s._v(" ],\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"EventKey"')]),s._v(": [ "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('""')]),s._v(" ] } \n   }\n")])]),a("p",[a("code",{pre:!0},[s._v("xml")]),s._v("为如上JSON "),a("code",{pre:!0},[s._v("_event")]),s._v("为 "),a("code",{pre:!0},[s._v("unsubscribe/subscribe")]),s._v(" 取消关注以及 取消关注")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 假如我要监听关注事件 代码为 ")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 调用方法为 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//  is_subscribe(xml,'subscribe')")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("is_subscribe")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("_props,_event")]),s._v(")")]),s._v("{\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(_props.xml.Event["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("] === _event){\n         "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n     }"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v("{\n         "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n     }\n }\n\n")])]),a("br"),a("br"),a("h3",[s._v("2基于express的完整代码 如果是关注公众号就触发事件")]),a("br"),a("h4",[s._v("2.1加密模式")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("router.post("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/bjyyq/openDev'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" xmlParse = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'xml2js'")]),s._v(").parseString;\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" data = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v("\n req.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'data'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("chunk")]),s._v(") ")]),s._v("{\n     data += chunk\n })\n req.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'end'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n         xmlParse(data, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" (err, result) => {\n             "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" wxConfig = {\n                 "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 传入配置信息")]),s._v("\n                 "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("token")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//管理后台配置的token")]),s._v("\n                 "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("appid")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//appid")]),s._v("\n                 "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("msg_signature")]),s._v(": req.query.msg_signature, "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//返回的msg_signature")]),s._v("\n                 "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("encodingAESKey")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//管理后台配置的encodingAESKey")]),s._v("\n             }\n             "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" WxCrypt = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./WXBizDataCrypt"')]),s._v(")\n             "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" wxCrypt = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" WxCrypt(wxConfig);\n             xmlParse(wxCrypt.decrypt(result.xml.Encrypt["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("]), (_err, _res) => {\n                 "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(is_subscribe(_res,"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'subscribe'")]),s._v(")){\n                     "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'某某用户关注'")]),s._v(")\n                 }\n                 "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("is_subscribe")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("_props,_event")]),s._v(")")]),s._v("{\n                    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(_props.xml.Event["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("] === _event){\n                        "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n                    }"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v("{\n                        "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n                    }\n                 }\n             })\n             res.send("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'mismatch'")]),s._v(");\n         })\n     })\n })\n\n")])]),a("br"),a("h4",[s._v("2.2普通模式")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("router.post("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/bjyyq/openDev'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") ")]),s._v("{\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" xmlParse = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'xml2js'")]),s._v(").parseString;\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" data = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v("\n   req.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'data'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("chunk")]),s._v(") ")]),s._v("{\n       data += chunk\n   })\n   req.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'end'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n       xmlParse(data, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" (err, result) => {\n           "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(is_subscribe(result,"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'subscribe'")]),s._v(")){\n                "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'某某用户关注'")]),s._v(")\n             }\n            "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("is_subscribe")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("_props,_event")]),s._v(")")]),s._v("{\n               "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(_props.xml.Event["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("] === _event){\n                   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n               }"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v("{\n                   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n               }\n            }\n           res.send("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'mismatch'")]),s._v(");\n       })\n   })\n})\n\n")])]),a("br"),a("p",[a("a",{attrs:{href:"https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Receiving_event_pushes.html#%E5%85%B3%E6%B3%A8/%E5%8F%96%E6%B6%88%E5%85%B3%E6%B3%A8%E4%BA%8B%E4%BB%B6"}},[s._v("关注/取消关注事件")])]),a("p",[a("a",{attrs:{href:"https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Message_encryption_and_decryption_instructions.html"}},[s._v("解密参考文档")])]),a("br")])}],n=a("2877"),l={},p=Object(n["a"])(l,e,r,!1,null,null,null);t["default"]=p.exports},"36ec":function(s,t,a){"use strict";a.r(t);var e=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},r=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("h2",[s._v("6.XML处理发送")]),a("br"),a("p",[s._v("来源：小白 时间：2020年12月24日15:36:05")]),a("hr"),a("blockquote",[a("p",[s._v("环境：node，crypto包")])]),a("blockquote",[a("p",[s._v("难度：简单")])]),a("h3",[s._v("1.回复文本消息")]),a("br"),a("h4",[s._v("1.1原生语法")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("<![CDATA[toUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("<![CDATA[fromUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("12345678"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("<![CDATA[text]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Content")]),s._v(">")]),s._v("<![CDATA[你好]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Content")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n\n")])]),a("br"),a("h4",[s._v("1.2封装处理")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("xmlText")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ToUserName,FromUserName,CreateTime,MsgType,Content}")]),s._v(")")]),s._v("{\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<xml>\n                <ToUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${ToUserName}")]),s._v("]]></ToUserName>\n                <FromUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${FromUserName}")]),s._v("]]></FromUserName>\n                <CreateTime>"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${CreateTime}")]),s._v("</CreateTime>\n                <MsgType><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${MsgType}")]),s._v("]]></MsgType>\n                <Content><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${Content}")]),s._v("]]></Content>\n            </xml>`")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 调用")]),s._v("\nxmlText({ToUserName,FromUserName,CreateTime,MsgType,Content})\n")])]),a("br"),a("h4",[s._v("1.x参数说明")]),a("br"),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("参数")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("是否必须")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("ToUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("接收方帐号（收到的OpenID）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("FromUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("开发者微信号")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("CreateTime")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息创建时间 （整型）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("MsgType")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息类型，文本为text")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Content")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("回复的消息内容（换行：在content中能够换行，微信客户端就支持换行显示）")])])])]),a("br"),a("h3",[s._v("2.回复图片消息")]),a("br"),a("h4",[s._v("2.1原生语法")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("<![CDATA[toUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("<![CDATA[fromUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("12345678"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("<![CDATA[image]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Image")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MediaId")]),s._v(">")]),s._v("<![CDATA[media_id]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MediaId")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Image")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n")])]),a("br"),a("h4",[s._v("2.2封装处理")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("xmlImage")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ToUserName,FromUserName,CreateTime,MsgType,MediaId}")]),s._v(")")]),s._v("{\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<xml>\n  <ToUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${ToUserName}")]),s._v("]]></ToUserName>\n  <FromUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${FromUserName}")]),s._v("]]></FromUserName>\n  <CreateTime>"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${CreateTime}")]),s._v("</CreateTime>\n  <MsgType><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${MsgType || "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'image'")]),s._v("}")]),s._v("]]></MsgType>\n  <Image>\n    <MediaId><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${MediaId}")]),s._v("]]></MediaId>\n  </Image>\n</xml>`")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 调用")]),s._v("\nxmlImage({ToUserName,FromUserName,CreateTime,MsgType,MediaId})\n")])]),a("br"),a("h4",[s._v("2.x参数说明")]),a("br"),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("参数")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("是否必须")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("ToUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("接收方帐号（收到的OpenID）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("FromUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("开发者微信号")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("CreateTime")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息创建时间 （整型）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("MsgType")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息类型，图片为image")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("MediaId")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("通过素材管理中的接口上传多媒体文件，得到的id。")])])])]),a("br"),a("h3",[s._v("3.回复语音消息")]),a("br"),a("h4",[s._v("3.1原生语法")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("<![CDATA[toUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("<![CDATA[fromUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("12345678"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("<![CDATA[voice]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Voice")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MediaId")]),s._v(">")]),s._v("<![CDATA[media_id]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MediaId")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Voice")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n")])]),a("br"),a("h4",[s._v("3.2封装处理")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("xmlVoice")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ToUserName,FromUserName,CreateTime,MsgType,MediaId}")]),s._v(")")]),s._v("{\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<xml>\n  <ToUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${ToUserName}")]),s._v("]]></ToUserName>\n  <FromUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${FromUserName}")]),s._v("]]></FromUserName>\n  <CreateTime>"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${CreateTime}")]),s._v("</CreateTime>\n  <MsgType><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${MsgType || "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"voice"')]),s._v("}")]),s._v("]]></MsgType>\n  <Voice>\n    <MediaId><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${MediaId}")]),s._v("]]></MediaId>\n  </Voice>\n</xml>`")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 调用")]),s._v("\nxmlVoice({ToUserName,FromUserName,CreateTime,MsgType,MediaId})\n")])]),a("br"),a("h4",[s._v("3.x参数说明")]),a("br"),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("参数")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("是否必须")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("ToUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("接收方帐号（收到的OpenID）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("FromUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("开发者微信号")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("CreateTime")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息创建时间 （整型）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("MsgType")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息类型，语音为voice")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("MediaId")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("通过素材管理中的接口上传多媒体文件，得到的id")])])])]),a("h3",[s._v("4.回复视频消息")]),a("br"),a("h4",[s._v("4.1原生语法")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("<![CDATA[toUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("<![CDATA[fromUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("12345678"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("<![CDATA[video]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Video")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MediaId")]),s._v(">")]),s._v("<![CDATA[media_id]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MediaId")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Title")]),s._v(">")]),s._v("<![CDATA[title]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Title")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Description")]),s._v(">")]),s._v("<![CDATA[description]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Description")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Video")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n")])]),a("br"),a("h4",[s._v("4.2封装处理")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("xmlVideo")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ToUserName,FromUserName,CreateTime,MsgType,MediaId,Title,Description}")]),s._v(")")]),s._v("{\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<xml>\n  <ToUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${ToUserName}")]),s._v("]]></ToUserName>\n  <FromUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${FromUserName}")]),s._v("]]></FromUserName>\n  <CreateTime>"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${CreateTime}")]),s._v("</CreateTime>\n  <MsgType><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${MsgType || "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"video"')]),s._v("}")]),s._v("]]></MsgType>\n  <Video>\n    <MediaId><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${MediaId}")]),s._v("]]></MediaId>\n    <Title><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${Title}")]),s._v("]]></Title>\n    <Description><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${Description}")]),s._v("]]></Description>\n  </Video>\n</xml>`")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 调用")]),s._v("\nxmlVideo({ToUserName,FromUserName,CreateTime,MsgType,MediaId,Title,Description})\n")])]),a("br"),a("h4",[s._v("4.x参数说明")]),a("br"),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("参数")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("是否必须")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("ToUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("接收方帐号（收到的OpenID）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("FromUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("开发者微信号")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("CreateTime")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息创建时间 （整型）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("MsgType")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息类型，语音为voice")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("MediaId")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("通过素材管理中的接口上传多媒体文件，得到的id")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Title")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("否")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("视频消息的标题")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Description")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("否")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("视频消息的描述")])])])]),a("br"),a("h3",[s._v("5.回复音乐消息")]),a("br"),a("h4",[s._v("5.1原生语法")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("<![CDATA[toUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("<![CDATA[fromUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("12345678"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("<![CDATA[music]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Music")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Title")]),s._v(">")]),s._v("<![CDATA[TITLE]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Title")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Description")]),s._v(">")]),s._v("<![CDATA[DESCRIPTION]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Description")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MusicUrl")]),s._v(">")]),s._v("<![CDATA[MUSIC_Url]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MusicUrl")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("HQMusicUrl")]),s._v(">")]),s._v("<![CDATA[HQ_MUSIC_Url]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("HQMusicUrl")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ThumbMediaId")]),s._v(">")]),s._v("<![CDATA[media_id]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ThumbMediaId")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Music")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n")])]),a("br"),a("h4",[s._v("5.2封装处理")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("xmlMusic")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ToUserName,FromUserName,CreateTime,MsgType,MediaId,Title,Description,MusicURL,HQMusicUrl,ThumbMediaId}")]),s._v(")")]),s._v("{\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<xml>\n  <ToUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${ToUserName}")]),s._v("]]></ToUserName>\n  <FromUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${FromUserName}")]),s._v("]]></FromUserName>\n  <CreateTime>"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${CreateTime}")]),s._v("</CreateTime>\n  <MsgType><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${MsgType || "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'music'")]),s._v("}")]),s._v("]]></MsgType>\n  <Music>\n    <Title><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${Title}")]),s._v("]]></Title>\n    <Description><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${Description}")]),s._v("]]></Description>\n    <MusicUrl><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${MusicURL}")]),s._v("]]></MusicUrl>\n    <HQMusicUrl><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${HQMusicUrl}")]),s._v("]]></HQMusicUrl>\n    <ThumbMediaId><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${ThumbMediaId}")]),s._v("]]></ThumbMediaId>\n  </Music>\n</xml>`")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 调用")]),s._v("\nxmlMusic({ToUserName,FromUserName,CreateTime,MsgType,MediaId,Title,Description,MusicURL,HQMusicUrl,ThumbMediaId})\n")])]),a("br"),a("h4",[s._v("5.x参数说明")]),a("br"),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("参数")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("是否必须")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("ToUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("接收方帐号（收到的OpenID）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("FromUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("开发者微信号")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("CreateTime")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息创建时间 （整型）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("MsgType")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息类型，音乐为musicTitle 否 音乐标题")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Description")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("否")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("音乐描述")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("MusicURL")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("否")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("音乐链接")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("HQMusicUrl")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("否")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("高质量音乐链接，WIFI环境优先使用该链接播放音乐")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("ThumbMediaId")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("缩略图的媒体id，通过素材管理中的接口上传多媒体文件，得到的id")])])])]),a("br"),a("h3",[s._v("6.回复音乐消息")]),a("br"),a("h4",[s._v("6.1原生语法")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("<![CDATA[toUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ToUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("<![CDATA[fromUser]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("FromUserName")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("12345678"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CreateTime")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("<![CDATA[music]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MsgType")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Music")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Title")]),s._v(">")]),s._v("<![CDATA[TITLE]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Title")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Description")]),s._v(">")]),s._v("<![CDATA[DESCRIPTION]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Description")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MusicUrl")]),s._v(">")]),s._v("<![CDATA[MUSIC_Url]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("MusicUrl")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("HQMusicUrl")]),s._v(">")]),s._v("<![CDATA[HQ_MUSIC_Url]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("HQMusicUrl")]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ThumbMediaId")]),s._v(">")]),s._v("<![CDATA[media_id]]>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ThumbMediaId")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Music")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("xml")]),s._v(">")]),s._v("\n")])]),a("br"),a("h4",[s._v("6.2封装处理")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// item的xml支持多个")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("xmlNews")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ToUserName,FromUserName,CreateTime,MsgType,ArticleCount,data}")]),s._v(")")]),s._v("{\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" itemXml = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v("\n    data.map("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("s")]),s._v(" =>")]),s._v("{\n        itemXml += "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<item>\n            <Title><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${s.Title}")]),s._v("]]></Title>\n            <Description><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${s.Description}")]),s._v("]]></Description>\n            <PicUrl><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${s.PicUrl}")]),s._v("]]></PicUrl>\n            <Url><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${s.Url}")]),s._v("]]></Url>\n        </item>`")]),s._v("\n    })\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<xml>\n    <ToUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${ToUserName}")]),s._v("]]></ToUserName>\n    <FromUserName><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${FromUserName}")]),s._v("]]></FromUserName>\n    <CreateTime>"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${CreateTime}")]),s._v("</CreateTime>\n    <MsgType><![CDATA["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${MsgType || "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"news"')]),s._v("}")]),s._v("]]></MsgType>\n    <ArticleCount>"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${ArticleCount}")]),s._v("</ArticleCount>\n    <Articles>\n      "),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${itemXml}")]),s._v("\n        \n    </Articles>\n    </xml>`")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 调用")]),s._v("\nxmlNews({ToUserName,FromUserName,CreateTime,MsgType,ArticleCount,data})\n")])]),a("br"),a("h4",[s._v("6.x参数说明")]),a("br"),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("参数")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("是否必须")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("ToUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("接收方帐号（收到的OpenID）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("FromUserName")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("开发者微信号")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("CreateTime")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息创建时间 （整型）")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("MsgType")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("消息类型，图文为news")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("ArticleCount")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("图文消息个数；当用户发送文本、图片、语音、视频、图文、地理位置这六种消息时，开发者只能回复1条图文消息；其余场景最多可回复8条图文消息")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Articles")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("图文消息信息，注意，如果图文数超过限制，则将只发限制内的条数")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("data")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("为数组 额外的数据")])])])]),a("p",[s._v("data的额外配置 data应该为个数组 方便渲染格式为")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[s._v("data = [\n    {\n        Title:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"图文版标题"')]),s._v(",\n        Description:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"图文描述"')]),s._v(",\n        PicUrl:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"图片链接，支持JPG、PNG格式，较好的效果为大图360"')]),s._v(",\n        Url:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"点击图文消息跳转链接"')]),s._v(",\n    },{\n        Title:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"图文版标题"')]),s._v(",\n        Description:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"图文描述"')]),s._v(",\n        PicUrl:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"图片链接，支持JPG、PNG格式，较好的效果为大图360"')]),s._v(",\n        Url:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"点击图文消息跳转链接"')]),s._v(",\n    },{\n        Title:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"图文版标题"')]),s._v(",\n        Description:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"图文描述"')]),s._v(",\n        PicUrl:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"图片链接，支持JPG、PNG格式，较好的效果为大图360"')]),s._v(",\n        Url:"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"点击图文消息跳转链接"')]),s._v(",\n    },\n]\n")])]),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("参数")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("是否必须")]),a("th",{staticStyle:{"text-align":"left"}},[s._v("描述")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Title")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("图文消息标题")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Description")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("图文消息描述")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("PicUrl")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("图片链接，支持JPG、PNG格式，较好的效果为大图360"),a("em",[s._v("200，小图200")]),s._v("200")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("Url")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("是")]),a("td",{staticStyle:{"text-align":"left"}},[s._v("点击图文消息跳转链接")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,e,r,!1,null,null,null);t["default"]=p.exports},"428d":function(s,t,a){"use strict";a.r(t);var e=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},r=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("h2",[s._v("5.服务器地址(URL)开发接入")]),a("br"),a("p",[s._v("来源：小白 时间：2020年12月24日15:36:05")]),a("hr"),a("blockquote",[a("p",[s._v("环境：node，crypto包")])]),a("blockquote",[a("p",[s._v("难度：简单")])]),a("blockquote",[a("p",[s._v("npm install xml2js")])]),a("p",[s._v("先上图看下作用在哪里")]),a("p",[a("img",{attrs:{src:"http://www.zzf9.com/admin/images/20-12-24-ter45.jpg",alt:"charles 1"}})]),a("p",[s._v("先生成所有数据 然后点击提交")]),a("p",[a("img",{attrs:{src:"http://www.zzf9.com/admin/images/20-12-24-q456.jpg",alt:"charles 1"}})]),a("p",[s._v("配置了以后请选择启用 才会生效欧")]),a("p",[a("img",{attrs:{src:"http://www.zzf9.com/admin/images/20-12-24-yhtr1.jpg",alt:"charles 1"}})]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/** \n    @description:开发接入\n    @param token {string} 必填 令牌(Token)\n    @return:\n*/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("getOpenDev")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ token }")]),s._v(") ")]),s._v("{\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" crypto = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'crypto'")]),s._v("); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//引入加密模块")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" signature = req.query.signature,"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//微信加密签名")]),s._v("\n        timestamp = req.query.timestamp,"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//时间戳")]),s._v("\n        nonce = req.query.nonce,"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//随机数")]),s._v("\n        echostr = req.query.echostr;"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//随机字符串")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//2.将token、timestamp、nonce三个参数进行字典序排序")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" array = [token, timestamp, nonce];\n    array.sort();\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//3.将三个参数字符串拼接成一个字符串进行sha1加密")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" tempStr = array.join("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v(");\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" hashCode = crypto.createHash("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'sha1'")]),s._v("); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//创建加密类型 ")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" resultCode = hashCode.update(tempStr, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'utf8'")]),s._v(").digest("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hex'")]),s._v("); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//对传入的字符串进行加密")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//4.开发者获得加密后的字符串可与signature对比，标识该请求来源于微信")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (resultCode === signature) {\n        res.send(echostr);\n    } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n        res.send("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'mismatch'")]),s._v(");\n    }\n}\n\n")])]),a("p",[s._v("说明利用字符串方式把"),a("code",{pre:!0},[s._v("Buffer")]),s._v("格式类型的数据解析出来 数据格式分为(明文/密文需要解密EncodingAESKey) ？此处是基于express的代码")]),a("blockquote",[a("p",[s._v("注意返回 分为加密/不加密格式，文档都有讲解")])]),a("blockquote",[a("p",[s._v("如果你懒得看叽叽歪歪的部分 ，可以直接下滑第三部分查看源码")])]),a("h3",[s._v("设置接收服务器返回数据（关注，取关，发送信息等 都是在这里触发）")]),a("blockquote",[a("p",[s._v("注意：此处返回分为加密格式跟不加密格式")])]),a("h4",[s._v("不加密代码写法 --基于express代码案例")]),a("p",[s._v("利用"),a("code",{pre:!0},[s._v("xml2js")]),s._v("包来解析返回的xml格式 定义成josn返回")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// post开放一个端口为bjyyq/openDev")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// req 接受  res 发送")]),s._v("\nrouter.post("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/bjyyq/openDev'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") ")]),s._v("{\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// xmlParse利用这个解析xml")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" xmlParse = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'xml2js'")]),s._v(").parseString;\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" data = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v("\n    req.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'data'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("chunk")]),s._v(") ")]),s._v("{\n        data += chunk\n    })\n    req.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'end'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        xmlParse(data, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" (err, result) => {\n            "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xml = result.xml "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//解析的数据")]),s._v("\n            res.send("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'mismatch'")]),s._v(");\n        })\n    })\n})\n")])]),a("h4",[s._v("加密代码写法 --基于express代码案例")]),a("p",[s._v("使用"),a("code",{pre:!0},[s._v("WXBizDataCrypt")]),s._v("文件进行解析加密前的数据，然后利用"),a("code",{pre:!0},[s._v("xml2js")]),s._v("包来解析返回的xml格式 定义成josn返回")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v(" router.post("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/bjyyq/openDev'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") ")]),s._v("{\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" xmlParse = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'xml2js'")]),s._v(").parseString;\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" data = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v("\n  req.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'data'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("chunk")]),s._v(") ")]),s._v("{\n      data += chunk\n  })\n  req.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'end'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n          xmlParse(data, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" (err, result) => {\n              "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" wxConfig = {\n                  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 传入配置信息")]),s._v("\n                  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("token")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//管理后台配置的token")]),s._v("\n                  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("appid")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//appid")]),s._v("\n                  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("msg_signature")]),s._v(": req.query.msg_signature, "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//返回的msg_signature")]),s._v("\n                  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("encodingAESKey")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//管理后台配置的encodingAESKey")]),s._v("\n              }\n              "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" WxCrypt = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./WXBizDataCrypt"')]),s._v(")\n              "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" wxCrypt = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" WxCrypt(wxConfig);\n              xmlParse(wxCrypt.decrypt(result.xml.Encrypt["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("]), (_err, _res) => {\n                  "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(_res)  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//为正常返回的XML格式的json")]),s._v("\n              })\n              res.send("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'mismatch'")]),s._v(");\n          })\n      })\n  })\n")])]),a("p",[s._v("解析后的json统一格式为")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[s._v("   { xml:\n        { ToUserName: [ 'xxxx' ],\n    FromUserName: [ 'xxxx' ],\n    CreateTime: [ 'xxxxx' ],\n    MsgType: [ 'event' ],\n    Event: [ 'unsubscribe' ],\n    EventKey: [ '' ] } \n   }\n")])]),a("h4",[s._v("完整代码 -不加密案例")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// catch 404 and forward to error handler")]),s._v("\nrouter.get("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/bjyyq/openDev'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") ")]),s._v("{\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" signature = req.query.signature,"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//微信加密签名")]),s._v("\n    timestamp = req.query.timestamp,"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//时间戳")]),s._v("\n    nonce = req.query.nonce,"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//随机数")]),s._v("\n    echostr = req.query.echostr;"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//随机字符串")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//2.将token、timestamp、nonce三个参数进行字典序排序")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" array = ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'fwefewfewfewfwefwe'")]),s._v(", timestamp, nonce];\n  array.sort();\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//3.将三个参数字符串拼接成一个字符串进行sha1加密")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" tempStr = array.join("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v(");\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" hashCode = crypto.createHash("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'sha1'")]),s._v("); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//创建加密类型 ")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" resultCode = hashCode.update(tempStr, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'utf8'")]),s._v(").digest("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hex'")]),s._v("); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//对传入的字符串进行加密")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//4.开发者获得加密后的字符串可与signature对比，标识该请求来源于微信")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (resultCode === signature) {\n    res.send(echostr);\n  } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n    res.send("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'mismatch'")]),s._v(");\n  }\n})\n\nrouter.post("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/bjyyq/openDev'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") ")]),s._v("{\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// xmlParse利用这个解析xml")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" xmlParse = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'xml2js'")]),s._v(").parseString;\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" data = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v("\n    req.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'data'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("chunk")]),s._v(") ")]),s._v("{\n        data += chunk\n    })\n    req.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'end'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        xmlParse(data, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" (err, result) => {\n            "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xml = result.xml "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//解析的数据")]),s._v("\n            res.send("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'mismatch'")]),s._v(");\n        })\n    })\n})\n\n")])]),a("h4",[s._v("WXBizDataCrypt文件的代码")]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-meta"}},[s._v("'use strict'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**\n * WxCrypt 微信消息加解密的方法\n * @return new WxCrypt(wxConfig)\n * 返回一个单例即可，不需要重复引用\n */")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" crypto = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'crypto'")]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-class"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("WxCrypt")]),s._v(" ")]),s._v("{\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("constructor")]),s._v("(opts) {\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//初始化需要用到的属性")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".token = opts.token;\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".appid = opts.appid;\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".msg_signature = opts.msg_signature; "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//query 传进来签名")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".aesKey = Buffer.from(opts.encodingAESKey + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'='")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'base64'")]),s._v(")\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".IV = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".aesKey.slice("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("16")]),s._v(")\n  }\n  encrypt(xmlMsg) {\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/*\n     *@params String xmlMsg 格式化后的 xml 字符串\n     *@return String 加密后的字符串 填入到 Encrypt 节点中\n     * 参照官方文档 需要返回一个buf: 随机16字节 + xmlMsg.length(4字节）+xmlMsg+appid。\n     * buf的字节长度需要填充到 32的整数，填充长度为 32-buf.length%32, 每一个字节为 32-buf.length%32\n     */")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" random16 = crypto.pseudoRandomBytes("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("16")]),s._v(");\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" msg = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Buffer(xmlMsg);\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" msgLength = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Buffer("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(");\n    msgLength.writeUInt32BE(msg.length, "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(");\n\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" corpId = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Buffer("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".appid);\n\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" raw_msg = Buffer.concat([random16, msgLength, msg, corpId]);\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" cipher = crypto.createCipheriv("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'aes-256-cbc'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".aesKey, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".IV);\n    cipher.setAutoPadding("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(");"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//重要，autopadding填充的内容无法正常解密")]),s._v("\n    raw_msg = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".PKCS7Encode(raw_msg);\n\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" cipheredMsg = Buffer.concat([cipher.update("),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/*encoded*/")]),s._v("raw_msg), cipher.final()]);\n\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" cipheredMsg.toString("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'base64'")]),s._v(");\n  }\n\n  decrypt(text) {\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/*\n     *@params String text 需要解密的字段（Encrypt节点中的内容）\n     * @return String msg_content 返回消息内容（xml字符串）\n     */")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" plain_text;\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" decipher = crypto.Decipheriv("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'aes-256-cbc'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".aesKey, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".IV)\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// crypto.Decipheriv == crypto.createDecipheriv 两个方法是一样的")]),s._v("\n    decipher.setAutoPadding("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(");"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//重要")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" decipheredBuff = Buffer.concat([decipher.update(text, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'base64'")]),s._v("), decipher.final()])\n    decipheredBuff = decipheredBuff\n    decipheredBuff = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".PKCS7Decode(decipheredBuff)\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" len_netOrder_corpid = decipheredBuff.slice("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("16")]),s._v(")\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//切割掉16个随机字符，剩余为 (4字节的 msg_len) + msg_content(长度为 msg_len ) + msg_appId ")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" msg_len = len_netOrder_corpid.slice("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(").readUInt32BE("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(")\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" msg_content = len_netOrder_corpid.slice("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(", msg_len + "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(").toString("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'utf-8'")]),s._v(")\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" msg_appId = len_netOrder_corpid.slice(msg_len + "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(").toString("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'utf-8'")]),s._v(")\n\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" msg_content\n  }\n  PKCS7Decode(buff) {\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/*\n     *去除尾部自动填充的内容\n     */")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" padContent = buff.length - "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (padContent < "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(" || padContent > "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("32")]),s._v(") {\n      padContent = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("\n    }\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" padLen = padContent;"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//根据填充规则，填充长度 = 填充内容，这一步赋值可以省略")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" buff.slice("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", buff.length - padLen)\n  }\n  PKCS7Encode(buff) {\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" blockSize = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("32")]),s._v(";\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" needPadLen = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("32")]),s._v(" - buff.length % "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("32")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (needPadLen == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(") {\n      needPadLen = blockSize\n    }\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" pad = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Buffer(needPadLen)\n    pad.fill(needPadLen)\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" newBuff = Buffer.concat([buff, pad])\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" newBuff\n  }\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("module")]),s._v(".exports = WxCrypt;\n\n")])]),a("br"),a("p",[a("a",{attrs:{href:"http://plug.zzf9.com/#/officialAccountsRender/A5"}},[s._v("发送的XML可以使用模板语法，可以查看此文章")])]),a("p",[a("a",{attrs:{href:"https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Message_encryption_and_decryption_instructions.html"}},[s._v("解密参考文档")])])])}],n=a("2877"),l={},p=Object(n["a"])(l,e,r,!1,null,null,null);t["default"]=p.exports},"4dcf":function(s,t,a){"use strict";a.r(t);var e=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},r=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("h2",[s._v("2.授权code获取openid openid获取用户信息")]),a("br"),a("p",[s._v("来源：小白 时间：2020年12月22日17:27:50")]),a("br"),a("hr"),a("blockquote",[a("p",[s._v("环境：node，request包")])]),a("blockquote",[a("p",[s._v("难度：简单")])]),a("br"),a("h4",[s._v("code获取openid")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用")]),s._v("\n\ngetCodeOpenId({appid, secret, access_token})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/** \n    @description:获取用户信息\n    @param appid {string} 公众号管理后台的appid\n\t@param secret {string} 公众号管理后台的secret\n\t@param code {string} 前端返回的code\n    @return:\n*/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("getCodeOpenId")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ appid, secret,access_token }")]),s._v(") ")]),s._v("{\n\trequest({\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("url")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`https://api.weixin.qq.com/sns/oauth2/access_token?appid="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${appid}")]),s._v("&secret="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${secret}")]),s._v("&code="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${code}")]),s._v("&grant_type=authorization_code`")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("method")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'get'")]),s._v(",\n\t},(err,res) =>{\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(err){\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(err) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//异常接口")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v("\n\t\t}"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v("{\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".parse(resv.body)) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//用户数据")]),s._v("\n\t\t}\n\t})\n}\n")])]),a("h3",[s._v("openid获取用户信息")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用")]),s._v("\n\ngetUserInfo({"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("appid")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"xxxxx"')]),s._v(","),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("secret")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"appsecret"')]),s._v("})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/** \n    @description:获取用户信息\n    @param appid {string} 个人信息的openid\n    @param access_token {string} access_token  \n    @return:\n*/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("getUserInfo")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ openid, access_token }")]),s._v(") ")]),s._v("{\n\trequest({\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("url")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`https://api.weixin.qq.com/cgi-bin/user/info?access_token="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${access_token}")]),s._v("&openid="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${openid}")]),s._v("&lang=zh_CN`")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("method")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'get'")]),s._v(",\n\t},(err,res) =>{\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(err){\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(err) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//异常接口")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v("\n\t\t}"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v("{\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".parse(resv.body)) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//用户数据")]),s._v("\n\t\t}\n\t})\n}\n")])]),a("p",[a("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/login/auth.code2Session.html#%E8%AF%B7%E6%B1%82%E5%9C%B0%E5%9D%80"}},[s._v("》此接口文档地址《")])])])}],n=a("2877"),l={},p=Object(n["a"])(l,e,r,!1,null,null,null);t["default"]=p.exports},"6cba":function(s,t,a){"use strict";a.r(t);var e=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"log"},[a("ul",s._l(s.list,(function(t,e){return a("li",{key:e,on:{click:function(t){return s.renderUrl(e)}}},[s._v(" "+s._s(t.replace(/(\.md|\.\/)/g,""))+" ")])})),0)])},r=[],n=(a("d3b7"),a("ddb0"),{data:function(){return{list:[]}},created:function(){var s=a("03e7");this.list=s.keys()},components:{},methods:{renderUrl:function(s){this.$router.push({path:"/officialAccountsRender/A"+s})}}}),l=n,p=(a("894b"),a("2877")),_=Object(p["a"])(l,e,r,!1,null,"35943128",null);t["default"]=_.exports},"6f09":function(s,t,a){"use strict";a.r(t);var e=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},r=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("h2",[s._v("1.access_token获取")]),a("br"),a("p",[s._v("来源：小白 时间：2020年12月22日17:27:50")]),a("br"),a("hr"),a("blockquote",[a("p",[s._v("环境：node，request包")])]),a("blockquote",[a("p",[s._v("难度：简单")])]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用")]),s._v("\n\ngetAccessToken({"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("appid")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"xxxxx"')]),s._v(","),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("secret")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"appsecret"')]),s._v("})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/** \n    @description:access_token获取\n    @param appid {string}\n    @param secret {string}\n    @return:\n*/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("getAccessToken")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ appid, secret }")]),s._v(") ")]),s._v("{\n\trequest({\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("url")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${appid}")]),s._v("&secret="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${secret}")]),s._v("`")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("method")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'get'")]),s._v(",\n\t},(err,res) =>{\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(err){\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(err) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//异常接口")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v("\n\t\t}"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v("{\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".parse(resv.body)) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//用户数据")]),s._v("\n\t\t}\n\t})\n}\n")])]),a("br"),a("h5",[a("a",{attrs:{href:"https://developers.weixin.qq.com/doc/offiaccount/Basic_Information/Get_access_token.html"}},[s._v("》官网文档传送门《")])])])}],n=a("2877"),l={},p=Object(n["a"])(l,e,r,!1,null,null,null);t["default"]=p.exports},"894b":function(s,t,a){"use strict";var e=a("fcdf"),r=a.n(e);r.a},b041:function(s,t,a){"use strict";var e=a("00ee"),r=a("f5df");s.exports=e?{}.toString:function(){return"[object "+r(this)+"]"}},d3b7:function(s,t,a){var e=a("00ee"),r=a("6eeb"),n=a("b041");e||r(Object.prototype,"toString",n,{unsafe:!0})},ddb0:function(s,t,a){var e=a("da84"),r=a("fdbc"),n=a("e260"),l=a("9112"),p=a("b622"),_=p("iterator"),v=p("toStringTag"),c=n.values;for(var i in r){var h=e[i],o=h&&h.prototype;if(o){if(o[_]!==c)try{l(o,_,c)}catch(m){o[_]=c}if(o[v]||l(o,v,i),r[i])for(var j in n)if(o[j]!==n[j])try{l(o,j,n[j])}catch(m){o[j]=n[j]}}}},f7fd:function(s,t,a){"use strict";a.r(t);var e=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},r=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("h2",[s._v("1.access_token获取")]),a("br"),a("p",[s._v("来源：小白 时间：2020年12月22日17:27:50")]),a("br"),a("hr"),a("blockquote",[a("p",[s._v("环境：html代码")])]),a("blockquote",[a("p",[s._v("难度：简单")])]),a("br"),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用")]),s._v("\n\nwindowAccredit({"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("appid")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"xxxxx"')]),s._v(","),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("redirect_uri")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"appsecret"')]),s._v(","),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("state")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('""')]),s._v("})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/** \n    @description:跳转授权\n    @param appid {string}\n    @param redirect_uri {string} 回调域名\n    @param state {string} 重定向后会带上state参数，开发者可以填写a-zA-Z0-9的参数值，最多128字节\n    @return:\n*/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("windowAccredit")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("{ appid,redirect_uri,state }")]),s._v(") ")]),s._v("{\n\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("window")]),s._v(".location.herf = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`https://open.weixin.qq.com/connect/oauth2/authorize?appid="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${appid}")]),s._v("&redirect_uri="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${redirect_uri}")]),s._v("&response_type=code&scope=snsapi_userinfo&state="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${state}")]),s._v("#wechat_redirect`")]),s._v("\n}\n")])]),a("br"),a("h5",[a("a",{attrs:{href:"https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html"}},[s._v("》官网文档传送门《")])])])}],n=a("2877"),l={},p=Object(n["a"])(l,e,r,!1,null,null,null);t["default"]=p.exports},fcdf:function(s,t,a){},fdbc:function(s,t){s.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);